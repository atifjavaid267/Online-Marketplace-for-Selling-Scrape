
<%= render 'users/navbar'%>

<div class="flex flex-row items-center justify-center">
  <div class="flex flex-row items-start justify-start my-20 w-full max-w-2xl">
    <div class="flex flex-col items-start justify-center space-y-8 flex-1">
      <div>
        <br><br><br>
        <%if @order.pending? %>
          <h3 class="font-bold text-blue-600 ml-2">Order is Pending!</h3> <br>
          <div class="flex flex-row items-center justify-center mt-10">
            <% if current_user.seller?%>
              <div class="mx-1">
                <%= button_to "Complete", confirm_order_path(@order),data: { confirm: "Are you sure to complete order?", turbo_confirm: "Are you sure to complete order?" },  class: "bg-blue-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition duration-300 ease-in-out"%>
              </div>
              <div>
                <%= button_to "Cancel", cancel_order_path(@order),data: { confirm: "Are you sure to cancel order?", turbo_confirm: "Are you sure to cancel order?" },  class: "bg-red-500 text-white px-8 py-2 rounded-lg shadow-md hover:bg-red-600 transition duration-300 ease-in-out"%>
              </div>
            <%end%>
          </div>
        <% elsif @order.successful? %>
            <h3 class="font-bold text-green-600 ml-1">Order has been Completed!</h3>
        <% elsif @order.cancelled?%>
            <h3 class="font-bold text-red-600 ml-1">Order has been Cancelled!</h3>
        <% end %>
      </div>
      <div>
        <button class="bg-gray-300 text-gray-800 ml-1 pl-8 pr-9 py-2 mb-2 rounded-lg shadow-md hover:bg-gray-400 transition duration-300 ease-in-out" onclick="window.history.back();">Back</button>
        <% if current_user.seller? %>
        <%= link_to "Message", new_message_path(order_id: @order.id),   class: "bg-green-500 text-white px-6 py-3 rounded-lg shadow-md hover:bg-green-600 transition duration-300 ease-in-out" %>
        <% elsif current_user.buyer? %>
          <%= link_to "Message", new_message_path(order_id: @order.id), class: "bg-green-500 text-white px-6 py-3 rounded-lg shadow-md hover:bg-green-600 transition duration-300 ease-in-out" %>
        <% end %>
      </div>
    </div>
    
  </div>
  <div class="flex flex-col items-start justify-center space-y-8 flex-1">
      <h4 class="font-semibold text-lg">Order Amount:</h4>
      <p class="text-gray-700 mb-6"><%= "Rs. #{@amount}" %></p>
      <% if current_user.seller? || current_user.admin? %>
        <h4 class="font-semibold text-lg">Buyer Name:</h4>
        <p class="text-gray-700 mb-6"><%= "#{@buyer.first_name} #{@buyer.last_name}" %></p>
      <%end%>

      <% if current_user.buyer? || current_user.admin? %>
        <h4 class="font-semibold text-lg">Seller Name:</h4>
        <p class="text-gray-700 mb-6"><%= "#{@seller.first_name} #{@seller.last_name}"%></p>
      <%end%>
        <h4 class="font-semibold text-lg">Pickup Date & Time:</h4>
        <p class="text-gray-700 mb-6"><%= @order.pickup_time.strftime('%d %B %Y | %I:%M:%S %p')%></p>
        <h4 class="font-semibold text-lg">Address:</h4>
        <p class="text-gray-700 mb-10"><%= "#{@address.street1} #{@address.street2}, #{@address.city}, #{@address.zip_code}" %></p>
      <div>

      <div id = "data" data-lat = <%= @address.latitude %>
  data-lon = <%= @address.longitude %>></div>
      <div id="map" class = "w-80 h-80" ></div>
   </div>
  <script>
  function initMap() {
    const mapDiv = document.getElementById('data')
    const lat = mapDiv.getAttribute('data-lat')
    const lon = mapDiv.getAttribute('data-lon')

  // var center = {lat: lat, lng: lon};
  const center = new google.maps.LatLng(lat, lon);

  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 8,
    center: center
  });

  var marker = new google.maps.Marker({
    position: center,
    map: map
  });
}

  
  
  </script>
<script defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBj6Z33I3_Uir3GBpjPtIlRAQsCADP8Ew0
        &libraries=visualization&callback=initMap">
    </script>

