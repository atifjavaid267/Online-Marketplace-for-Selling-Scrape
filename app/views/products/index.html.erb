
<% flag = true %>
<% if @products.empty? %>
  <% flag = false %>
<% elsif current_user.seller? %>
  <% unless @products.find_by(status: true) %>
    <% flag = false%>
  <%end%>
<% end %>

<%if !flag %>
  <div class="bg-cover bg-no-repeat h-screen" style="background-image: url('https://images.unsplash.com/photo-1475275083424-b4ff81625b60?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1472&q=80');">
  <%= render 'devise/shared/navbar' %>
  <%= render 'devise/shared/back' %>
    <div class = "pt-5">
      <div class ="bg-gray-800" style="border: 2px; margin: 100px; padding: 40px; border-radius: 10px; color: white; opacity: 0.95;">
        <h1 class="text-center font-bold">No Product Available!</h1>
      </div>
      <%if current_user.admin?%>
        <div class="my-6 flex justify-center">
          <%= link_to "Add Product", new_product_path, class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"%>
        </div>
      <%end%>
    </div>
  </div>
<% else %>
  <%= render 'devise/shared/navbar' %>
  <div class="bg-white "></div>
    <table class="w-full">
      <thead>
        <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
        <th class="py-3 px-6 text-left font-bold"> Name</th>
          <th class="py-3 px-6 text-left"> Image</th>
          <%if current_user.admin?%>
            <th class="py-3 px-6 text-center" colspan="3">Actions</th>
          <%elsif current_user.seller?%>
            <th class="py-3 px-6 text-center">View Product Details</th>
          <%end%>
        </tr>
      </thead>
      <tbody class="text-gray-600 text-sm font-light">
        <% @products.each do |product|%>
          <tr class="border-b border-gray-200 hover:bg-gray-100 shadow-md rounded border">
            <td class="py-3 px-6 text-left whitespace-nowrap font-bold"><%= product.name%></td>
            <% if product.product_image.attached? %>
              <td class="py-3 px-3 text-left"><%= image_tag product.product_image, style: "length: 100px; width: 70px"%></td>
            <%end%>
            <!-- <td class="py-3 px-6 text-left"><%= product.description%></td> -->
            <td class="py-3 px-6 text-center">
               <%= link_to "View", product, class: "bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"%>
            </td>
            <%if current_user.admin? %>
              <% if can? :unpublish, Product %>
                <td class="py-3 px-6 text-center"><%= button_to "Unpublish", unpublish_product_path(product),data: { confirm: "Are you sure to unpublish product?", turbo_confirm: "Are you sure to unpublish product?" }, method: :post, class: "bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"%></td>
              <%end%>
              <% if can? :destroy, Product %>
                <td class="py-3 px-6 text-center"><%= button_to "Delete", product, data: { confirm: "Are you sure to delete product?", turbo_confirm: "Are you sure to delete product?" }, method: :delete, class: "bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded"%></td>
              <%end%>
            <%end%>
          </tr>
        <%end%>
      </tbody>
    </table>
  </div>

  <div class = "py-4 flex flex-row items-center justify-center">
    <%= will_paginate @products, class:"bg-gray-300 rounded py-3 px-4"%>
  </div>

  <%if current_user.admin?%>
    <div class="flex justify-center mb-2">
      <%= link_to "Add Product", new_product_path, class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"%>
    </div>
  <%end%>
<% end %>

